import { usePage } from '@inertiajs/react';
import { useState } from 'react';
// start lang
import ar from '@/translation/ar'
import en from '@/translation/en'
// end lang


export default function PasswordInput({
  id,
  label,
  value,
  onChange,
  placeholder,
  error,
  required = false,
  valid = false,
  className = '',
  ...rest
}) {
  const [showPassword, setShowPassword] = useState(false);

  const togglePasswordVisibility = () => {
    setShowPassword(!showPassword);
  };

  // Determine input state for styling
  const hasError = !!error;
  const isValid = valid && !hasError;

  // Input classes based on state
  const inputClasses = `
        w-full p-3 border rounded focus:outline-none bg-white
        ${hasError ? 'border-error focus:ring-2 focus:ring-error/30' :
      isValid ? 'border-success focus:ring-2 focus:ring-success/30' :
        'border-gray-300 focus:ring-2 focus:ring-secondary-500/30'}
    `;

  // Start language
  const lang = usePage().props.locale;
  const tr = lang === 'ar' ? ar : en;
  // end lang
  return (
    <div className={`mb-4 ${className}`}>
      {label && (
        <label htmlFor={id} className="block mb-2 text-black text-sm sm:text-base">
          {label} {required && <span className="text-error">*</span>}
        </label>
      )}

      <div className="relative">
        <input
          id={id}
          type={showPassword ? "text" : "password"}
          value={value}
          onChange={onChange}
          placeholder={placeholder}
          className={inputClasses + " text-sm sm:text-base "}
          {...rest}
        />

        {/* Password toggle button */}
        <button
          type="button"
          className={
            "absolute text-gray-400 transform -translate-y-1/2 top-1/2 " +
            (lang === "ar" ? "left-3 " : "right-3")
          }
          onClick={togglePasswordVisibility}
          tabIndex="-1"
        >
          {showPassword ? (
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12.4217 14.1369L17.2767 18.9912C17.3946 19.1051 17.5525 19.1681 17.7164 19.1667C17.8802 19.1652 18.037 19.0995 18.1529 18.9836C18.2688 18.8677 18.3345 18.711 18.3359 18.5471C18.3373 18.3832 18.2743 18.2254 18.1605 18.1075L1.91049 1.85749C1.85284 1.7978 1.78387 1.75018 1.70762 1.71743C1.63137 1.68467 1.54936 1.66743 1.46637 1.66671C1.38338 1.66599 1.30108 1.6818 1.22427 1.71323C1.14746 1.74465 1.07768 1.79106 1.019 1.84975C0.960313 1.90843 0.913905 1.97821 0.882479 2.05502C0.851054 2.13183 0.83524 2.21413 0.835961 2.29712C0.836682 2.3801 0.853924 2.46212 0.886679 2.53837C0.919435 2.61462 0.967049 2.68359 1.02674 2.74124L4.27049 5.98499C1.77674 7.95374 0.880493 10.8287 0.867993 10.8744C0.767993 11.2056 0.955493 11.5494 1.28674 11.6494C1.61799 11.7494 1.96799 11.5619 2.06799 11.2306C2.11362 11.0719 2.91674 8.52874 5.14674 6.86187L7.13112 8.84624C6.7432 9.1839 6.42889 9.59774 6.20771 10.062C5.98653 10.5263 5.86322 11.0312 5.84545 11.5451C5.82767 12.0591 5.9158 12.5713 6.10436 13.0497C6.29293 13.5282 6.5779 13.9628 6.94155 14.3264C7.30521 14.6901 7.73978 14.9751 8.21825 15.1636C8.69672 15.3522 9.20886 15.4403 9.72284 15.4225C10.2368 15.4048 10.7416 15.2814 11.2059 15.0603C11.6702 14.8391 12.0841 14.5248 12.4217 14.1369ZM11.5349 13.2494C11.3141 13.5209 11.0388 13.7431 10.7268 13.9015C10.4148 14.0599 10.073 14.151 9.72347 14.169C9.374 14.187 9.02464 14.1314 8.698 14.0058C8.37137 13.8803 8.07473 13.6875 7.82729 13.4401C7.57984 13.1926 7.3871 12.896 7.26154 12.5694C7.13597 12.2427 7.08038 11.8934 7.09835 11.5439C7.11633 11.1944 7.20747 10.8526 7.36589 10.5406C7.52431 10.2285 7.74647 9.95324 8.01799 9.73249L11.5349 13.2494ZM9.31424 7.93437L10.9599 9.58062C11.2499 9.76999 11.4974 10.0181 11.6874 10.3075L13.3336 11.9537C13.3399 11.8612 13.3432 11.7681 13.3436 11.6744C13.3437 11.1583 13.2372 10.6478 13.0309 10.1748C12.8246 9.70183 12.523 9.27649 12.1447 8.92544C11.7665 8.57438 11.3199 8.30516 10.8329 8.13463C10.3458 7.9641 9.82884 7.89592 9.31424 7.93437ZM6.21237 4.83249L7.17799 5.79937C7.957 5.54553 8.77182 5.41891 9.59112 5.42437C15.2817 5.42437 17.038 10.9887 17.1149 11.2306C17.1961 11.4994 17.4461 11.6744 17.7149 11.6744V11.6681C17.8122 11.669 17.9084 11.647 17.9957 11.6039C18.0829 11.5608 18.1588 11.4978 18.2172 11.4199C18.2756 11.342 18.3149 11.2515 18.3319 11.1557C18.3488 11.0598 18.343 10.9613 18.3149 10.8681C18.2955 10.8056 16.2267 4.17437 9.59049 4.17437C8.29674 4.17437 7.17737 4.42624 6.21237 4.83249Z" fill="#A7A7A7" />
            </svg>
          ) : (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M21.0256 12.9675C21.1231 13.29 21.4231 13.5 21.7456 13.5V13.4925C21.8624 13.4936 21.9778 13.4672 22.0825 13.4155C22.1873 13.3637 22.2783 13.2881 22.3484 13.1946C22.4185 13.1012 22.4656 12.9926 22.486 12.8775C22.5063 12.7625 22.4993 12.6443 22.4656 12.5325C22.4423 12.4575 19.9598 4.5 11.9963 4.5C4.03283 4.5 1.55258 12.4575 1.53008 12.54C1.41008 12.9375 1.63508 13.35 2.03258 13.47C2.43008 13.59 2.85008 13.365 2.97008 12.9675C3.05183 12.6825 5.16683 6 11.9971 6C18.8258 6 20.9333 12.6773 21.0256 12.9675ZM9.00008 13.5C9.00008 12.7044 9.31615 11.9413 9.87876 11.3787C10.4414 10.8161 11.2044 10.5 12.0001 10.5C12.7957 10.5 13.5588 10.8161 14.1214 11.3787C14.684 11.9413 15.0001 12.7044 15.0001 13.5C15.0001 14.2956 14.684 15.0587 14.1214 15.6213C13.5588 16.1839 12.7957 16.5 12.0001 16.5C11.2044 16.5 10.4414 16.1839 9.87876 15.6213C9.31615 15.0587 9.00008 14.2956 9.00008 13.5ZM12.0001 9C10.8066 9 9.66201 9.47411 8.8181 10.318C7.97419 11.1619 7.50008 12.3065 7.50008 13.5C7.50008 14.6935 7.97419 15.8381 8.8181 16.682C9.66201 17.5259 10.8066 18 12.0001 18C13.1936 18 14.3381 17.5259 15.1821 16.682C16.026 15.8381 16.5001 14.6935 16.5001 13.5C16.5001 12.3065 16.026 11.1619 15.1821 10.318C14.3381 9.47411 13.1936 9 12.0001 9Z" fill="#0E0E0E" />
            </svg>
          )}
        </button>

        {/* Status icon for validation states */}
        {isValid && (
          <div className={
            "absolute transform -translate-y-1/2 top-1/2 " +
            (lang === "ar" ? "left-10 rotate-180" : "right-10")
          }>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 0C3.58862 0 0 3.58862 0 8C0 12.4114 3.58862 16 8 16C12.4114 16 16 12.4114 16 8C16 3.58862 12.4114 0 8 0ZM11.8047 6.4L7.59864 10.6061C7.55178 10.6529 7.49695 10.69 7.43693 10.7154C7.37691 10.7407 7.31287 10.7538 7.24819 10.7538C7.18351 10.7538 7.11947 10.7407 7.05945 10.7154C6.99944 10.69 6.9446 10.6529 6.89775 10.6061L4.19526 7.90358C4.09809 7.80642 4.04362 7.67405 4.04362 7.53585C4.04362 7.39764 4.09809 7.26528 4.19526 7.16811C4.29242 7.07095 4.42479 7.01648 4.56299 7.01648C4.7012 7.01648 4.83356 7.07095 4.93073 7.16811L7.24819 9.48557L11.0693 5.66446C11.1664 5.5673 11.2988 5.51283 11.437 5.51283C11.5752 5.51283 11.7076 5.5673 11.8047 5.66446C11.9019 5.76163 11.9564 5.894 11.9564 6.0322C11.9564 6.1704 11.9019 6.30277 11.8047 6.39993V6.4Z" fill="#2BB900" />
            </svg>
          </div>
        )}
      </div>

      {/* Display error message */}
      {hasError && (
        <div className="mt-1 text-sm text-error">
          {error}
        </div>
      )}

      {/* Display validation success message */}
      {isValid && !hasError && (
        <div className="mt-1 text-sm text-success">
          Valid input
        </div>
      )}
    </div>
  );
}
